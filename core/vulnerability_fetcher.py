import requests
import json

def fetch_nvd_data(keyword):
    url = f"https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch={keyword}"
    response = requests.get(url)
    
    try:
        response.raise_for_status()  # Raise HTTPError for bad responses (4xx and 5xx)
        return response.json()
    except requests.exceptions.HTTPError as http_err:
        print(f"HTTP error occurred: {http_err}")
        print(f"Response status code: {response.status_code}")
        print(f"Response content: {response.text}")
    except requests.exceptions.RequestException as req_err:
        print(f"Request error occurred: {req_err}")
    except ValueError as json_err:
        print(f"JSON decode error occurred: {json_err} - Response content: {response.text}")
    return None

def fetch_and_store_vulnerabilities(keyword, output_file):
    data = fetch_nvd_data(keyword)
    if data:
        with open(output_file, 'w') as f:
            json.dump(data, f, indent=4)
        print(f"Vulnerabilities stored in {output_file}")

if __name__ == "__main__":
    fetch_and_store_vulnerabilities("Samsung", "samsung_vulnerabilities.json")
    fetch_and_store_vulnerabilities("Philips", "philips_vulnerabilities.json")
    fetch_and_store_vulnerabilities("Amazon", "amazon_vulnerabilities.json")
