import sys
import os

# Add the project directory to the Python path
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

from core.vulnerability_matching import match_vulnerabilities
from tests.mock_arp_output import mock_arp_output

def test_vulnerability_integration():
    for device in mock_arp_output:
        print(f"Testing device: {device['manufacturer']} {device['device_type']}")
        vulnerabilities = match_vulnerabilities(device)
        if vulnerabilities:
            print("Matched Vulnerabilities:")
            for vulnerability in vulnerabilities:
                print(vulnerability)
        else:
            print("No vulnerabilities found or an error occurred.")

if __name__ == "__main__":
    test_vulnerability_integration()


